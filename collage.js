!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){e.exports=React},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(2),o=n(3);a.render(r.createElement(o.default,null),document.getElementById("app"))},function(e,t){e.exports=ReactDOM},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var o=arguments[t],i=0,s=o.length;i<s;i++,a++)r[a]=o[i];return r};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),l=n(4),p=n(5),u=function(e){return s.createElement("div",null,s.createElement("h3",null,"Images"),s.createElement("div",{style:{overflowY:"auto",width:300,height:400,border:"1px solid #888",backgroundColor:"#f7f7f7",borderRadius:"1em",display:"grid",gridTemplateColumns:"1fr 1fr 1fr"}},e.images.map((function(e,t){return s.createElement(c,o({key:t},e))}))))},c=function(e){return e.error?s.createElement("div",{style:{color:"red"}},e.name):s.createElement("div",{style:{display:"grid"}},s.createElement("div",null,s.createElement("img",{src:e.data,width:64,height:64})),s.createElement("div",null,e.name))},h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={images:[],width:512,height:512,rows:4,columns:4},n.onImageUpload=n.onImageUpload.bind(n),n.onImageError=n.onImageError.bind(n),n.onImageSwap=n.onImageSwap.bind(n),n.onImageRemove=n.onImageRemove.bind(n),n}return a(t,e),t.prototype.onImageUpload=function(e,t){var n=i(this.state.images);n.push({name:e,data:t,error:!1}),this.setState({images:n})},t.prototype.onImageError=function(e){var t=i(this.state.images);t.push({name:e,error:!0}),this.setState({images:t})},t.prototype.onImageSwap=function(e,t){if(Math.floor(e)==e&&Math.floor(t)==t&&!(e<0||e>=this.state.images.length||t<0||t>=this.state.images.length)){var n=i(this.state.images),r=n[e];n[e]=n[t],n[t]=r,this.setState({images:n})}},t.prototype.onImageRemove=function(e){if(!(Math.floor(e)!=e||e<0||e>=this.state.images.length)){var t=i(this.state.images);t.splice(e,1),this.setState({images:t})}},t.prototype.render=function(){var e=this;return s.createElement("div",null,s.createElement("h1",null,"Collage Designer"),s.createElement("div",{style:{display:"grid",gridTemplateColumns:"380px auto"}},s.createElement("div",null,s.createElement(u,{images:this.state.images}),s.createElement("div",null,s.createElement("h3",null,"Add"),s.createElement(p.default,{onImageUpload:this.onImageUpload,onImageError:this.onImageError})),s.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 3fr"}},s.createElement("h3",{style:{gridColumnStart:1,gridColumnEnd:3}},"Properties"),s.createElement("div",null,"Width"),s.createElement("div",null,s.createElement("input",{type:"text",value:this.state.width,size:2,onChange:function(t){return e.setState({width:parseInt(t.target.value)})}})),s.createElement("div",null,"Height"),s.createElement("div",null,s.createElement("input",{type:"text",value:this.state.height,size:2,onChange:function(t){return e.setState({height:parseInt(t.target.value)})}})),s.createElement("div",null,"Rows"),s.createElement("div",null,s.createElement("input",{type:"text",value:this.state.rows,size:2,onChange:function(t){return e.setState({rows:parseInt(t.target.value)})}})),s.createElement("div",null,"Columns"),s.createElement("div",null,s.createElement("input",{type:"text",value:this.state.columns,size:2,onChange:function(t){return e.setState({columns:parseInt(t.target.value)})}})))),s.createElement("div",null,s.createElement("h3",null,"Collage"),s.createElement("div",{style:{backgroundColor:"#eee",borderRadius:"1em",display:"inline-block"}},s.createElement(l.default,o({},this.state,{onImageSwap:this.onImageSwap,onImageRemove:this.onImageRemove}))))))},t}(s.Component);t.default=h},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return n.canvas=null,n.state={swap:-1,rendering:!1},n.onImageClick=n.onImageClick.bind(n),n.onImageRemove=n.onImageRemove.bind(n),n.renderImage=n.renderImage.bind(n),n.canvas=document.createElement("canvas"),n}return a(t,e),t.prototype.onImageClick=function(e){-1!=this.state.swap?(this.props.onImageSwap&&this.props.onImageSwap(this.state.swap,e),this.setState({swap:-1})):this.setState({swap:e})},t.prototype.onImageRemove=function(){-1!=this.state.swap&&(this.props.onImageRemove&&this.props.onImageRemove(this.state.swap),this.setState({swap:-1}))},t.prototype.render=function(){var e=this,t=this.props.width/this.props.columns,n=Array(this.props.columns).fill(t+"px").join(" "),r=this.props.height/this.props.rows,a=Array(this.props.rows).fill(r+"px").join(" "),i=this.props.rows*this.props.columns;this.canvas.width=this.props.width,this.canvas.height=this.props.height;var s=this.canvas.getContext("2d");s.fillRect(0,0,this.props.width,this.props.height);for(var l=[],p=function(n){var a=u.props.images[n];if(a.data&&u.state.rendering){var i=n%u.props.columns*t,p=Math.floor(n/u.props.columns)*r,c=new Image(t,r);c.onload=function(e){console.log("Render "+a.name),s.drawImage(c,0,0,c.naturalWidth,c.naturalHeight,i,p,t,r)},c.src=a.data}var h={};n==u.state.swap?(h.border="2px solid red",h.width=t-4,h.height=r-4):(h.width=t,h.height=r),l.push(o.createElement("div",{key:n},o.createElement("img",{style:h,src:a.data,onClick:function(t){return e.onImageClick(n)}})))},u=this,c=0;c<i&&c<this.props.images.length;c++)p(c);return o.createElement("div",{style:{margin:"1em"}},o.createElement("div",{style:{margin:"0.25em",width:this.props.width,height:this.props.height,display:"grid",backgroundColor:"#FFF",gridTemplateColumns:n,gridTemplateRows:a}},l),o.createElement("button",{style:{width:75,height:25,margin:"0.25em"},disabled:!this.state.rendering,onClick:this.renderImage},"Save"),o.createElement("button",{style:{backgroundColor:this.state.rendering?"red":"silver",width:75,height:25,margin:"0.25em"},onClick:function(t){return e.setState({rendering:!e.state.rendering})}},"Rendering"),o.createElement("button",{style:{width:150,height:25,margin:"0.25em"},disabled:this.state.swap<0,onClick:this.onImageRemove},"Remove"," ",this.state.swap>=0?this.props.images[this.state.swap].name:""),o.createElement("div",{style:{display:this.state.file?"inline-block":"none"}},"Download"," ",o.createElement("a",{href:this.state.file,download:this.state.name,style:{display:this.state.file?"inline":"none"}},this.state.name)))},t.prototype.renderImage=function(){var e=(new Date).toLocaleString();this.setState({file:this.canvas.toDataURL("image/jpeg"),name:"collage-"+e+".jpg"})},t}(o.Component);t.default=i},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var o=arguments[t],i=0,s=o.length;i<s;i++,a++)r[a]=o[i];return r};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=function(e){function t(t){var n=e.call(this,t)||this;return n.state={pending:[],working:!1,current:null},n.onFileChange=n.onFileChange.bind(n),n}return a(t,e),t.prototype.onFileChange=function(e){for(var t=this,n=o(this.state.pending),r=0;r<e.target.files.length;r++)n.push(e.target.files[r]);this.setState({pending:n},(function(){t.state.working||t.setState({working:!0},(function(){return t.processPending()}))}))},t.prototype.processPending=function(){var e=this;if(0!=this.state.pending.length){var t=o(this.state.pending),n=t.shift(),r=new FileReader;r.onload=function(t){e.props.onImageUpload&&e.props.onImageUpload(n.name,t.target.result),e.processPending()},r.onerror=function(t){e.props.onImageError&&e.props.onImageError(n.name),e.processPending()},r.readAsDataURL(n),this.setState({pending:t,current:n})}else this.setState({working:!1})},t.prototype.render=function(){return i.createElement("div",null,i.createElement("input",{type:"file",multiple:!0,accept:"image/*",onChange:this.onFileChange}),i.createElement("div",null,this.state.working?"Uploading...":""))},t}(i.Component);t.default=s}]);
//# sourceMappingURL=collage.js.map